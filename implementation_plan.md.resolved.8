# TV Time Giver App - CV Edition Implementation Plan

## Goal
Build a premium web application that uses **Computer Vision (webcam)** to automatically count exercises and award TV time.

## User Review Required
- **Webcam Usage**: The app will require camera access. All processing is done locally in your browser (privacy focused).
- **Complexity**: This is a more complex app. I will split it into 3 files ([index.html](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/index.html), [script.js](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/script.js), [style.css](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/style.css)) in the artifacts folder, which you can keep together in a folder on your desktop.
-   **Reporting**: [finishAndReport()](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/script.js#182-207) constructs **Gmail Web** link (User Request).
-   **Approval**: State machine for `Waiting` -> `Success` / `Fail`.
-   **Jumping Jacks**: Detect Arms Up/Legs Out vs Arms Down/Legs In.
-   **Body Saw Plank**: 
    -   Track relative horizontal distance between shoulder and elbow landmarks.
    -   Count rep when body shifts backward and returns to starting plank position.
    -   Threshold: ~50% of upper arm length displacement.
-   **Form Correction**: 
    -   Calculate angles real-time.
-   **All Day Mode**: New feature for continuous monitoring.
-   **Approval Screen**:
    -   Apps enters "Waiting" state.
    -   Shows "Approve" (Green) and "Decline" (Red) buttons (Simulating Parent).
    -   **Approved**: Shows "Watch TV" screen.
    -   **Declined**: Shows "No TV" screen.

## Automated Approval (Gmail API)
-   **Integration**: Add Google API Client Library (GAPI).
-   **Authentication**: Implement OAuth 2.0 flow.
-   **Polling**: Background task that checks Gmail every 30 seconds for messages:
    -   **Criteria**: `from:venky24aug@gmail.com "ok"` or `"no"`.
    -   **Thread Check**: Link to the current workout session ID for accuracy.
-   **User Setup**: User will need to provide a `CLIENT_ID` from Google Cloud Console.

## Phase 6: Google Sheets Data Persistence
-   **Objective**: Save workout history to a permanent Google Sheet.
-   **Authentication**: Expand `SCOPES` to include `spreadsheets` and `userinfo.profile`.
-   **Feature: Google Login**:
    -   New Login screen on first load.
    -   "Register" button (same as Login) to initialize the user's TV Time Sheet.
-   **Sync Logic**:
    -   Check if a sheet named "TV_Time_Data" exists.
    -   If not, create it with headers: `Date`, `User`, [Exercise](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/script.js#380-456), `Value`, `Total_Earned`.
    -   `syncToSheets()`: Append a new row every time an exercise session is finished or a milestone is reached.
-   **User Setup**: User must enable **"Google Sheets API"** in the Cloud Console.

### 4. File Structure
Same 3-file structure ([index.html](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/index.html), [script.js](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/script.js), [style.css](file:///C:/Users/hi%20coder/.gemini/antigravity/brain/cb0f6429-b178-4e8f-9b39-4dffcef35e2d/style.css)), but significant logic rewrite.

## Verification Plan
### Automated Tests
- Unit tests for the "Angle Calculation" functions.

### Manual Verification
- I will launch the app and perform a walkthrough of the new AI features.
- Test Voice Feedback (needs browser audio).
- Test Chatbot responses.
